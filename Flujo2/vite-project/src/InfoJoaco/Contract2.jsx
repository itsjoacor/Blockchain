// SPDX-License-Identifier: MIT
//contact_Address= 0x2E14CD8D9ecfF34c941c69acE8FD9c17020Ef6Cb 
pragma solidity ^0.8.20;

contract CustomERC1155 {
    uint256 public currentTokenId = 0;
    address public owner;

    struct Metadata {
        string titulo;
        string descripcion;
        string nombre;
        string fecha;
        string imageUrl;
    }

    mapping(uint256 => Metadata) public metadatas;
    mapping(address => mapping(uint256 => uint256)) public balances;

    event TransferSingle(address indexed operator, address indexed from, address indexed to, uint256 id, uint256 value);

    constructor() {
        owner = msg.sender;
    }

    modifier onlyOwner() {
        require(msg.sender == owner, "Solo el owner puede ejecutar esta funcion");
        _;
    }

    function mintConMetadata(
        address to,
        string memory titulo,
        string memory descripcion,
        string memory nombre,
        string memory fecha,
        string memory imageUrl
    ) public onlyOwner {
        uint256 tokenId = currentTokenId;
        balances[to][tokenId] = 1;

        metadatas[tokenId] = Metadata({
            titulo: titulo,
            descripcion: descripcion,
            nombre: nombre,
            fecha: fecha,
            imageUrl: imageUrl
        });

        emit TransferSingle(msg.sender, address(0), to, tokenId, 1);
        currentTokenId++;
    }

    function balanceOf(address account, uint256 id) external view returns (uint256) {
        return balances[account][id];
    }

    // Returns metadata for a token
    function getMetadata(uint256 tokenId) public view returns (
        string memory titulo,
        string memory descripcion,
        string memory nombre,
        string memory fecha,
        string memory imageUrl
    ) {
        Metadata memory data = metadatas[tokenId];
        return (data.titulo, data.descripcion, data.nombre, data.fecha, data.imageUrl);
    }

    // Standard ERC1155 URI function (returns a dummy URI since we store metadata on-chain)
    function uri(uint256 tokenId) public view returns (string memory) {
        return string(abi.encodePacked(
            "data:application/json;utf8,{\"name\":\"NFT #", 
            toString(tokenId), 
            "\",\"description\":\"On-chain metadata NFT\",",
            "\"image\":\"", metadatas[tokenId].imageUrl, "\"}"
        ));
    }

    // Helper function to convert uint to string
    function toString(uint256 value) internal pure returns (string memory) {
        if (value == 0) return "0";
        uint256 temp = value;
        uint256 digits;
        while (temp != 0) {
            digits++;
            temp /= 10;
        }
        bytes memory buffer = new bytes(digits);
        while (value != 0) {
            digits -= 1;
            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));
            value /= 10;
        }
        return string(buffer);
    }
}



ABI:

[
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "string",
				"name": "titulo",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "descripcion",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "nombre",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "fecha",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "imageUrl",
				"type": "string"
			}
		],
		"name": "mintConMetadata",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "operator",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "id",
				"type": "uint256"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "TransferSingle",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "account",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "id",
				"type": "uint256"
			}
		],
		"name": "balanceOf",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"name": "balances",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "currentTokenId",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "getMetadata",
		"outputs": [
			{
				"internalType": "string",
				"name": "titulo",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "descripcion",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "nombre",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "fecha",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "imageUrl",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"name": "metadatas",
		"outputs": [
			{
				"internalType": "string",
				"name": "titulo",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "descripcion",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "nombre",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "fecha",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "imageUrl",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "uri",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
]




BYTECODE:
60806040525f80553480156011575f80fd5b503360015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506118ce8061005f5f395ff3fe608060405234801561000f575f80fd5b5060043610610084575f3560e01c8063a574cea411610059578063a574cea414610124578063ab7c1eea14610158578063cbf1304d14610174578063e73496cd146101a457610084565b80629a9b7b14610088578062fdd58e146100a65780630e89341c146100d65780638da5cb5b14610106575b5f80fd5b6100906101d8565b60405161009d9190610c4c565b60405180910390f35b6100c060048036038101906100bb9190610cfa565b6101dd565b6040516100cd9190610c4c565b60405180910390f35b6100f060048036038101906100eb9190610d38565b610233565b6040516100fd9190610dd3565b60405180910390f35b61010e610279565b60405161011b9190610e02565b60405180910390f35b61013e60048036038101906101399190610d38565b61029e565b60405161014f959493929190610e1b565b60405180910390f35b610172600480360381019061016d9190610fbb565b6105c0565b005b61018e60048036038101906101899190610cfa565b6107eb565b60405161019b9190610c4c565b60405180910390f35b6101be60048036038101906101b99190610d38565b61080b565b6040516101cf959493929190610e1b565b60405180910390f35b5f5481565b5f60035f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8381526020019081526020015f2054905092915050565b606061023e82610adb565b60025f8481526020019081526020015f2060040160405160200161026392919061136d565b6040516020818303038152906040529050919050565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60608060608060605f60025f8881526020019081526020015f206040518060a00160405290815f820180546102d290611261565b80601f01602080910402602001604051908101604052809291908181526020018280546102fe90611261565b80156103495780601f1061032057610100808354040283529160200191610349565b820191905f5260205f20905b81548152906001019060200180831161032c57829003601f168201915b5050505050815260200160018201805461036290611261565b80601f016020809104026020016040519081016040528092919081815260200182805461038e90611261565b80156103d95780601f106103b0576101008083540402835291602001916103d9565b820191905f5260205f20905b8154815290600101906020018083116103bc57829003601f168201915b505050505081526020016002820180546103f290611261565b80601f016020809104026020016040519081016040528092919081815260200182805461041e90611261565b80156104695780601f1061044057610100808354040283529160200191610469565b820191905f5260205f20905b81548152906001019060200180831161044c57829003601f168201915b5050505050815260200160038201805461048290611261565b80601f01602080910402602001604051908101604052809291908181526020018280546104ae90611261565b80156104f95780601f106104d0576101008083540402835291602001916104f9565b820191905f5260205f20905b8154815290600101906020018083116104dc57829003601f168201915b5050505050815260200160048201805461051290611261565b80601f016020809104026020016040519081016040528092919081815260200182805461053e90611261565b80156105895780601f1061056057610100808354040283529160200191610589565b820191905f5260205f20905b81548152906001019060200180831161056c57829003601f168201915b5050505050815250509050805f01518160200151826040015183606001518460800151955095509550955095505091939590929450565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461064f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016106469061142c565b60405180910390fd5b5f80549050600160035f8973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8381526020019081526020015f20819055506040518060a001604052808781526020018681526020018581526020018481526020018381525060025f8381526020019081526020015f205f820151815f0190816106f191906115d5565b50602082015181600101908161070791906115d5565b50604082015181600201908161071d91906115d5565b50606082015181600301908161073391906115d5565b50608082015181600401908161074991906115d5565b509050508673ffffffffffffffffffffffffffffffffffffffff165f73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fc3d58168c5ae7397731d063d5bbf3d657854427343f4c083240f7aacaa2d0f628460016040516107c49291906116dd565b60405180910390a45f808154809291906107dd90611731565b919050555050505050505050565b6003602052815f5260405f20602052805f5260405f205f91509150505481565b6002602052805f5260405f205f91509050805f01805461082a90611261565b80601f016020809104026020016040519081016040528092919081815260200182805461085690611261565b80156108a15780601f10610878576101008083540402835291602001916108a1565b820191905f5260205f20905b81548152906001019060200180831161088457829003601f168201915b5050505050908060010180546108b690611261565b80601f01602080910402602001604051908101604052809291908181526020018280546108e290611261565b801561092d5780601f106109045761010080835404028352916020019161092d565b820191905f5260205f20905b81548152906001019060200180831161091057829003601f168201915b50505050509080600201805461094290611261565b80601f016020809104026020016040519081016040528092919081815260200182805461096e90611261565b80156109b95780601f10610990576101008083540402835291602001916109b9565b820191905f5260205f20905b81548152906001019060200180831161099c57829003601f168201915b5050505050908060030180546109ce90611261565b80601f01602080910402602001604051908101604052809291908181526020018280546109fa90611261565b8015610a455780601f10610a1c57610100808354040283529160200191610a45565b820191905f5260205f20905b815481529060010190602001808311610a2857829003601f168201915b505050505090806004018054610a5a90611261565b80601f0160208091040260200160405190810160405280929190818152602001828054610a8690611261565b8015610ad15780601f10610aa857610100808354040283529160200191610ad1565b820191905f5260205f20905b815481529060010190602001808311610ab457829003601f168201915b5050505050905085565b60605f8203610b21576040518060400160405280600181526020017f30000000000000000000000000000000000000000000000000000000000000008152509050610c2f565b5f8290505f5b5f8214610b50578080610b3990611731565b915050600a82610b4991906117a5565b9150610b27565b5f8167ffffffffffffffff811115610b6b57610b6a610e97565b5b6040519080825280601f01601f191660200182016040528015610b9d5781602001600182028036833780820191505090505b5090505b5f8514610c2857600182610bb591906117d5565b9150600a85610bc49190611808565b6030610bd09190611838565b60f81b818381518110610be657610be561186b565b5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690815f1a905350600a85610c2191906117a5565b9450610ba1565b8093505050505b919050565b5f819050919050565b610c4681610c34565b82525050565b5f602082019050610c5f5f830184610c3d565b92915050565b5f604051905090565b5f80fd5b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f610c9f82610c76565b9050919050565b610caf81610c95565b8114610cb9575f80fd5b50565b5f81359050610cca81610ca6565b92915050565b610cd981610c34565b8114610ce3575f80fd5b50565b5f81359050610cf481610cd0565b92915050565b5f8060408385031215610d1057610d0f610c6e565b5b5f610d1d85828601610cbc565b9250506020610d2e85828601610ce6565b9150509250929050565b5f60208284031215610d4d57610d4c610c6e565b5b5f610d5a84828501610ce6565b91505092915050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f610da582610d63565b610daf8185610d6d565b9350610dbf818560208601610d7d565b610dc881610d8b565b840191505092915050565b5f6020820190508181035f830152610deb8184610d9b565b905092915050565b610dfc81610c95565b82525050565b5f602082019050610e155f830184610df3565b92915050565b5f60a0820190508181035f830152610e338188610d9b565b90508181036020830152610e478187610d9b565b90508181036040830152610e5b8186610d9b565b90508181036060830152610e6f8185610d9b565b90508181036080830152610e838184610d9b565b90509695505050505050565b5f80fd5b5f80fd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b610ecd82610d8b565b810181811067ffffffffffffffff82111715610eec57610eeb610e97565b5b80604052505050565b5f610efe610c65565b9050610f0a8282610ec4565b919050565b5f67ffffffffffffffff821115610f2957610f28610e97565b5b610f3282610d8b565b9050602081019050919050565b828183375f83830152505050565b5f610f5f610f5a84610f0f565b610ef5565b905082815260208101848484011115610f7b57610f7a610e93565b5b610f86848285610f3f565b509392505050565b5f82601f830112610fa257610fa1610e8f565b5b8135610fb2848260208601610f4d565b91505092915050565b5f805f805f8060c08789031215610fd557610fd4610c6e565b5b5f610fe289828a01610cbc565b965050602087013567ffffffffffffffff81111561100357611002610c72565b5b61100f89828a01610f8e565b955050604087013567ffffffffffffffff8111156110305761102f610c72565b5b61103c89828a01610f8e565b945050606087013567ffffffffffffffff81111561105d5761105c610c72565b5b61106989828a01610f8e565b935050608087013567ffffffffffffffff81111561108a57611089610c72565b5b61109689828a01610f8e565b92505060a087013567ffffffffffffffff8111156110b7576110b6610c72565b5b6110c389828a01610f8e565b9150509295509295509295565b5f81905092915050565b7f646174613a6170706c69636174696f6e2f6a736f6e3b757466382c7b226e616d5f8201527f65223a224e465420230000000000000000000000000000000000000000000000602082015250565b5f6111346029836110d0565b915061113f826110da565b602982019050919050565b5f61115482610d63565b61115e81856110d0565b935061116e818560208601610d7d565b80840191505092915050565b7f222c226465736372697074696f6e223a224f6e2d636861696e206d65746164615f8201527f7461204e4654222c000000000000000000000000000000000000000000000000602082015250565b5f6111d46028836110d0565b91506111df8261117a565b602882019050919050565b7f22696d616765223a2200000000000000000000000000000000000000000000005f82015250565b5f61121e6009836110d0565b9150611229826111ea565b600982019050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f600282049050600182168061127857607f821691505b60208210810361128b5761128a611234565b5b50919050565b5f819050815f5260205f209050919050565b5f81546112af81611261565b6112b981866110d0565b9450600182165f81146112d357600181146112e85761131a565b60ff198316865281151582028601935061131a565b6112f185611291565b5f5b83811015611312578154818901526001820191506020810190506112f3565b838801955050505b50505092915050565b7f227d0000000000000000000000000000000000000000000000000000000000005f82015250565b5f6113576002836110d0565b915061136282611323565b600282019050919050565b5f61137782611128565b9150611383828561114a565b915061138e826111c8565b915061139982611212565b91506113a582846112a3565b91506113b08261134b565b91508190509392505050565b7f536f6c6f20656c206f776e657220707565646520656a656375746172206573745f8201527f612066756e63696f6e0000000000000000000000000000000000000000000000602082015250565b5f611416602983610d6d565b9150611421826113bc565b604082019050919050565b5f6020820190508181035f8301526114438161140a565b9050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026114947fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82611459565b61149e8683611459565b95508019841693508086168417925050509392505050565b5f819050919050565b5f6114d96114d46114cf84610c34565b6114b6565b610c34565b9050919050565b5f819050919050565b6114f2836114bf565b6115066114fe826114e0565b848454611465565b825550505050565b5f90565b61151a61150e565b6115258184846114e9565b505050565b5b818110156115485761153d5f82611512565b60018101905061152b565b5050565b601f82111561158d5761155e81611291565b6115678461144a565b81016020851015611576578190505b61158a6115828561144a565b83018261152a565b50505b505050565b5f82821c905092915050565b5f6115ad5f1984600802611592565b1980831691505092915050565b5f6115c5838361159e565b9150826002028217905092915050565b6115de82610d63565b67ffffffffffffffff8111156115f7576115f6610e97565b5b6116018254611261565b61160c82828561154c565b5f60209050601f83116001811461163d575f841561162b578287015190505b61163585826115ba565b86555061169c565b601f19841661164b86611291565b5f5b828110156116725784890151825560018201915060208501945060208101905061164d565b8683101561168f578489015161168b601f89168261159e565b8355505b6001600288020188555050505b505050505050565b5f819050919050565b5f6116c76116c26116bd846116a4565b6114b6565b610c34565b9050919050565b6116d7816116ad565b82525050565b5f6040820190506116f05f830185610c3d565b6116fd60208301846116ce565b9392505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f61173b82610c34565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff820361176d5761176c611704565b5b600182019050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f6117af82610c34565b91506117ba83610c34565b9250826117ca576117c9611778565b5b828204905092915050565b5f6117df82610c34565b91506117ea83610c34565b925082820390508181111561180257611801611704565b5b92915050565b5f61181282610c34565b915061181d83610c34565b92508261182d5761182c611778565b5b828206905092915050565b5f61184282610c34565b915061184d83610c34565b925082820190508082111561186557611864611704565b5b92915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffdfea26469706673582212206392b2f4db5512c51c5cb1ff9e86f31fc7f89661bb72c86b49473621d6c8971064736f6c634300081a0033